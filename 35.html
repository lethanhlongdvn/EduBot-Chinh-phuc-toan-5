<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>V√≤ng Quay May M·∫Øn - Tu·∫ßn 35</title>
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

    <style>
        :root { --main-color: #ff4757; --sec-color: #2f3542; --gold: #ffa502; --win: #2ed573; }
        body { font-family: 'Lexend', sans-serif; margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; background: var(--sec-color); color: #fff; user-select: none; }
        .game-box { max-width: 750px; width: 100%; background: #57606f; padding: 30px; border-radius: 25px; border: 4px solid var(--gold); box-shadow: 0 15px 40px rgba(0,0,0,0.4); }
        .header { display: flex; justify-content: space-between; font-weight: bold; color: var(--gold); margin-bottom: 20px; border-bottom: 2px solid #747d8c; padding-bottom: 10px; }
        .screen { background: #2f3542; border-radius: 15px; padding: 25px; margin-bottom: 25px; min-height: 160px; display: flex; flex-direction: column; justify-content: center; text-align: center; }
        .q-tag { font-size: 0.8rem; text-transform: uppercase; color: var(--gold); margin-bottom: 10px; letter-spacing: 2px; }
        .q-text { font-size: 1.3rem; line-height: 1.6; }
        .input-zone { display: flex; flex-direction: column; gap: 15px; }
        .ans-input { padding: 20px; border-radius: 15px; border: 3px solid var(--gold); background: #fff; color: #2f3542; font-size: 1.8rem; text-align: center; font-family: 'Lexend'; font-weight: bold; outline: none; }
        .btn-submit { background: var(--main-color); color: white; padding: 18px; border: none; border-radius: 15px; font-weight: bold; cursor: pointer; font-size: 1.2rem; box-shadow: 0 6px 0 #b33939; transition: 0.2s; }
        .btn-submit:active { transform: translateY(3px); box-shadow: 0 2px 0 #b33939; }
        #toast { position: fixed; top: 30px; padding: 15px 40px; border-radius: 50px; font-weight: bold; z-index: 1000; opacity: 0; transition: 0.3s; pointer-events: none; border: 2px solid #fff; }
        .show-toast { opacity: 1 !important; top: 50px !important; }
        .hidden { display: none; }
    </style>
</head>
<body>

<div id="toast"></div>

<div class="header" style="width: 100%; max-width: 750px;">
    <span id="vong-thi">V√íNG QUAY MAY M·∫ÆN</span>
    <span id="diem-so">ƒêI·ªÇM: 0</span>
</div>

<div class="game-box">
    <div id="play-area">
        <div class="screen">
            <span class="q-tag" id="q-label">C√¢u h·ªèi 1</span>
            <div id="q-content" class="q-text">ƒêang chu·∫©n b·ªã ƒë·ªÅ thi...</div>
        </div>
        <div class="input-zone">
            <input type="text" id="user-ans" class="ans-input" placeholder="Nh·∫≠p k·∫øt qu·∫£..." autocomplete="off">
            <button class="btn-submit" onclick="checkAnswer()">G·ª¨I K·∫æT QU·∫¢</button>
        </div>
    </div>

    <div id="result-screen" class="hidden" style="text-align: center;">
        <h2 style="color: var(--gold);">KHO B√ÅU TRI TH·ª®C</h2>
        <h1 id="final-score" style="font-size: 5rem; margin: 20px 0;">0</h1>
        <div id="save-form">
            <input type="text" id="p-name" style="width:80%; padding:15px; margin:5px; border-radius:10px;" placeholder="T√™n h·ªçc sinh...">
            <input type="text" id="p-class" style="width:80%; padding:15px; margin:5px; border-radius:10px;" placeholder="L·ªõp...">
            <button class="btn-submit" style="width:85%; margin-top:15px;" onclick="saveData()">L∆ØU B·∫¢NG V√ÄNG</button>
        </div>
        <button class="btn-submit" style="background:#747d8c; box-shadow:0 6px 0 #2f3542; margin-top:20px;" onclick="location.reload()">CH∆†I L·∫†I</button>
    </div>
</div>

<script>
    let score = 0;
    let currentIdx = 0;
    let gameData = [];

    const firebaseConfig = {
        apiKey: "AIzaSyC6zlWn8BKYU7P6A2-PYq6IIWOzaqJWFhc",
        authDomain: "gamhoctap.firebaseapp.com",
        databaseURL: "https://gamhoctap-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "gamhoctap"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // 30 B√ÄI C∆† B·∫¢N
    const POOL_CO_BAN = [
        {q: "S·ªë 121 783 907, ch·ªØ s·ªë 7 thu·ªôc h√†ng n√†o? (ƒêi·ªÅn: h√†ng trƒÉm ngh√¨n/h√†ng ch·ª•c ngh√¨n/...)", a: "h√†ng trƒÉm ngh√¨n"},
        {q: "L√†m tr√≤n s·ªë 105 362 480 ƒë·∫øn h√†ng ngh√¨n:", a: "105362000"},
        {q: "Vi·∫øt ph√¢n s·ªë 317/100 d∆∞·ªõi d·∫°ng s·ªë th·∫≠p ph√¢n:", a: "3.17"},
        {q: "R√∫t g·ªçn ph√¢n s·ªë 15/21 v·ªÅ ph√¢n s·ªë t·ªëi gi·∫£n:", a: "5/7"},
        {q: "R√∫t g·ªçn ph√¢n s·ªë 72/120 v·ªÅ ph√¢n s·ªë t·ªëi gi·∫£n:", a: "3/5"},
        {q: "T√≠nh: 536,817 + 82,579 =", a: "619.396"},
        {q: "T√≠nh: 64,38 + 93,46 =", a: "157.84"},
        {q: "T√≠nh nhanh: 275 + (725 + 486) =", a: "1486"},
        {q: "T√¨m x bi·∫øt: a + x = a. x l√† s·ªë m·∫•y?", a: "0"},
        {q: "T√≠nh: 32,6 x 0,58 =", a: "18.908"},
        {q: "T√≠nh: 98,28 : 3,6 =", a: "27.3"},
        {q: "T√≠nh nh·∫©m: 27,6 x 10 =", a: "276"},
        {q: "T√≠nh nh·∫©m: 432 x 0,1 =", a: "43.2"},
        {q: "ƒê·ªïi ƒë∆°n v·ªã: 1,5 km = ... m", a: "1500"},
        {q: "ƒê·ªïi ƒë∆°n v·ªã: 3 t·∫•n 66 kg = ... t·∫•n", a: "3.066"},
        {q: "ƒê·ªïi ƒë∆°n v·ªã: 1,6 ha = ... m¬≤", a: "16000"},
        {q: "ƒê·ªïi ƒë∆°n v·ªã: 5 m¬≥ 68 dm¬≥ = ... m¬≥", a: "5.068"},
        {q: "Chu vi h√¨nh vu√¥ng c√≥ c·∫°nh 60m l√† (m):", a: "240"},
        {q: "Di·ªán t√≠ch tam gi√°c c√≥ ƒë√°y 5cm, cao 4cm (cm¬≤):", a: "10"},
        {q: "Di·ªán t√≠ch h√¨nh thang c√≥ ƒë√°y l·ªõn 50m, ƒë√°y b√© 30m, cao 25m (m¬≤):", a: "1000"},
        {q: "Chu vi ƒëƒ©a s·ª© h√¨nh tr√≤n ƒë∆∞·ªùng k√≠nh 24cm (cm):", a: "75.36"},
        {q: "Th·ªÉ t√≠ch h√¨nh h·ªôp ch·ªØ nh·∫≠t: d√†i 8cm, r·ªông 5cm, cao 6cm (cm¬≥):", a: "240"},
        {q: "Di·ªán t√≠ch to√†n ph·∫ßn h√¨nh l·∫≠p ph∆∞∆°ng c·∫°nh 1,5m (m¬≤):", a: "13.5"},
        {q: "T√¨m t·ªâ s·ªë ph·∫ßn trƒÉm c·ªßa 49 v√† 70 (%):", a: "70"},
        {q: "T√≠nh 10% c·ªßa 60 l√≠t (l):", a: "6"},
        {q: "L·ªõp c√≥ 32 HS, 12 b·∫°n xu·∫•t s·∫Øc. T·ªâ s·ªë ph·∫ßn trƒÉm HS xu·∫•t s·∫Øc l√† (%):", a: "37.5"},
        {q: "V·∫≠n t·ªëc √¥ t√¥ ƒëi 180km trong 2 gi·ªù (km/h):", a: "90"},
        {q: "Qu√£ng ƒë∆∞·ªùng t√†u ƒëi trong 2,5 gi·ªù v·ªõi v·∫≠n t·ªëc 32km/h (km):", a: "80"},
        {q: "Th·ªùi gian ch·∫°y 400m v·ªõi v·∫≠n t·ªëc 5m/s (gi√¢y):", a: "80"},
        {q: "Bi·ªÉu ƒë·ªì c√≥ 45% HS th√≠ch l·ªõp 3 trong t·ªïng 100 em. S·ªë em l·ªõp 3 l√†:", a: "45"}
    ];

    // 10 B√ÄI N√ÇNG CAO
    const POOL_NANG_CAO = [
        {q: "T√†u d√†i 200m, v=20m/s qua h·∫ßm d√†i 600m. Sau bao l√¢u ƒëu√¥i t√†u ra kh·ªèi h·∫ßm (gi√¢y)?", a: "40"},
        {q: "Kh·ªëi g·ªó HHCN b·ªã c·∫Øt ƒëi m·ªôt h√¨nh l·∫≠p ph∆∞∆°ng c·∫°nh 2dm. Th·ªÉ t√≠ch gi·∫£m ƒëi bao nhi√™u dm¬≥?", a: "8"},
        {q: "B·ªÉ cao 50cm, n∆∞·ªõc ƒëang cao 3/4 b·ªÉ. Chi·ªÅu cao n∆∞·ªõc hi·ªán t·∫°i l√† bao nhi√™u cm?", a: "37.5"},
        {q: "Gi·∫£m 10% c·ªßa 350.000ƒë r·ªìi gi·∫£m ti·∫øp 5% tr√™n gi√° m·ªõi. Gi√° cu·ªëi l√† (ƒë·ªìng):", a: "299250"},
        {q: "C√¥ Hoa g·ª≠i 50tr l√£i 8%/nƒÉm. Sau 1 nƒÉm c·∫£ g·ªëc l·∫´n l√£i l√† (tri·ªáu ƒë·ªìng):", a: "54"},
        {q: "Hai xe c√°ch 115km. Xe A ƒëi 22km/h, xe B ƒëi 24km/h ng∆∞·ª£c chi·ªÅu. Sau m·∫•y gi·ªù g·∫∑p nhau?", a: "2.5"},
        {q: "H√¨nh thang tƒÉng ƒë√°y l·ªõn 10m th√¨ di·ªán t√≠ch tƒÉng 50m¬≤. Chi·ªÅu cao h√¨nh thang l√† (m):", a: "10"},
        {q: "Kh√°n ƒë√†i C c√≥ 3600 ng∆∞·ªùi (chi·∫øm 18%). T·ªïng s·ªë kh√°n gi·∫£ to√†n s√¢n l√†:", a: "20000"},
        {q: "Gieo x√∫c x·∫Øc 9 l·∫ßn, m·∫∑t ch·∫µn xu·∫•t hi·ªán 4 l·∫ßn. T·ªâ s·ªë kh·∫£ nƒÉng m·∫∑t l·∫ª xu·∫•t hi·ªán l√† (ph√¢n s·ªë):", a: "5/9"},
        {q: "Di·ªán t√≠ch 10.000km¬≤, m·∫≠t ƒë·ªô 80 ng∆∞·ªùi/km¬≤. Mu·ªën tƒÉng m·∫≠t ƒë·ªô l√™n 90 th√¨ d√¢n s·ªë tƒÉng th√™m bao nhi√™u?", a: "100000"}
    ];

    function initGame() {
        const shuffleCB = POOL_CO_BAN.sort(() => 0.5 - Math.random()).slice(0, 8);
        const shuffleNC = POOL_NANG_CAO.sort(() => 0.5 - Math.random()).slice(0, 2);
        gameData = [...shuffleCB, ...shuffleNC];
        showQ();
    }

    function showQ() {
        const item = gameData[currentIdx];
        document.getElementById('q-label').innerText = `Th·ª≠ th√°ch ${currentIdx + 1}/10 ${currentIdx >= 8 ? "- N√ÇNG CAO" : ""}`;
        document.getElementById('q-content').innerText = item.q;
        document.getElementById('user-ans').value = "";
        document.getElementById('user-ans').focus();
    }

    function checkAnswer() {
        const userVal = document.getElementById('user-ans').value.trim().toLowerCase().replace(',', '.');
        const correctVal = gameData[currentIdx].a.toLowerCase();

        if (userVal === correctVal) {
            score += (currentIdx >= 8 ? 20 : 10);
            toast("CH√çNH X√ÅC! üåü", "#2ed573");
        } else {
            toast("CH∆ØA ƒê√öNG! ‚ùå", "#ff4757");
        }
        
        document.getElementById('diem-so').innerText = "ƒêI·ªÇM: " + score;
        setTimeout(next, 1000);
    }

    function next() {
        currentIdx++;
        if (currentIdx < gameData.length) showQ();
        else finish();
    }

    function toast(m, c) {
        const t = document.getElementById('toast');
        t.innerText = m; t.style.background = c;
        t.classList.add('show-toast');
        setTimeout(() => t.classList.remove('show-toast'), 800);
    }

    function finish() {
        document.getElementById('play-area').classList.add('hidden');
        document.getElementById('result-screen').classList.remove('hidden');
        document.getElementById('final-score').innerText = score;
    }

    function saveData() {
        const n = document.getElementById('p-name').value;
        const c = document.getElementById('p-class').value;
        if(!n || !c) return;
        db.ref('ketqua/tuan35/' + Date.now()).set({ ten: n, lop: c, diem: score, ngay: new Date().toLocaleDateString() })
        .then(() => { alert("ƒê√£ l∆∞u k·∫øt qu·∫£ vinh quang!"); location.reload(); });
    }

    // Cho ph√©p nh·∫•n Enter ƒë·ªÉ g·ª≠i
    document.getElementById('user-ans').addEventListener('keypress', (e) => {
        if(e.key === 'Enter') checkAnswer();
    });

    window.onload = initGame;
</script>
</body>
</html>