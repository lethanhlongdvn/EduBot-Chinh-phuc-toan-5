<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>H√†nh Tr√¨nh Xuy√™n Vi·ªát: EduRobot To√°n 5</title>
    <link href="https://fonts.googleapis.com/css2?family=Bungee&family=Lexend:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        :root { --primary: #FF9800; --dark-green: #2e7d32; --gold: #ffd700; --bg-dark: #1a1a1a; }
        body { margin: 0; padding: 0; font-family: 'Lexend', sans-serif; background-color: var(--bg-dark); color: white; overflow-x: hidden; }

        /* BANNER & HEADER */
        .welcome-banner { background: linear-gradient(90deg, #1a1a1a, #333, #1a1a1a); padding: 15px 20px; border-bottom: 2px solid var(--primary); text-align: center; }
        .welcome-text { font-family: 'Bungee'; font-size: clamp(1rem, 4vw, 1.8rem); color: white; text-shadow: 2px 2px 0px var(--primary); }
        .game-header { background: #222; padding: 10px 20px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #333; }

        /* MAP & STATIONS */
        .map-container { position: relative; background: #2c2c2c; border-radius: 15px; padding: 10px; margin: 15px; }
        .map-relative-box { position: relative; width: 100%; }
        .map-image { width: 100%; height: auto; display: block; border-radius: 10px; }

        .station { position: absolute; width: 5.8%; aspect-ratio: 1/1; background: white; border: 2px solid var(--dark-green); border-radius: 50%; display: flex; justify-content: center; align-items: center; font-weight: bold; color: var(--dark-green); font-size: clamp(8px, 1.6vw, 16px); z-index: 10; cursor: pointer; transition: 0.2s; }
        
        /* Tr·∫°ng th√°i KH√ìA */
        .station.locked { background: #333 !important; border-color: #555 !important; color: #777 !important; opacity: 0.6; filter: grayscale(1); cursor: not-allowed; }
        .station.locked::after { content: 'üîí'; position: absolute; font-size: 10px; bottom: -12px; }

        /* FORM NH·∫¨P T√äN */
        #auth-overlay { position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:99999; display:none; justify-content:center; align-items:center; }
        .auth-card { background:#222; padding:30px; border-radius:20px; border:2px solid var(--primary); width:85%; max-width:350px; text-align:center; }
        .auth-card input { width:100%; padding:12px; margin:10px 0; border-radius:8px; border:1px solid #444; background:#111; color:white; box-sizing:border-box; }

        .game-footer { background: #222; padding: 10px; border-top: 3px solid var(--primary); position: sticky; bottom: 0; display: flex; gap: 10px; justify-content: center; }
        .btn-nav { background: #333; border: 1px solid var(--primary); color: var(--primary); padding: 10px 20px; border-radius: 8px; font-weight: bold; text-decoration: none; font-size: 0.8rem; }
        
        /* T·ªåA ƒê·ªò TR·∫†M */
        #st-19 { top: 1.5%; left: 40%; } #st-20 { top: 8%; left: 45%; } #st-21 { top: 10%; left: 23%; }
        #st-22 { top: 12%; left: 40%; } #st-23 { top: 17%; left: 54%; } #st-24 { top: 27%; left: 44%; }
        #st-25 { top: 38%; left: 52%; } #st-26 { top: 46%; left: 63%; } #st-27 { top: 54%; left: 70%; }
        #st-28 { top: 62%; left: 73%; } #st-29 { top: 70%; left: 74%; } #st-30 { top: 71%; left: 56%; }
        #st-31 { top: 79%; left: 50%; } #st-32 { top: 80%; left: 35%; } #st-33 { top: 89%; left: 35%; }
        #st-34 { top: 90%; left: 80%; } #st-35 { top: 46%; left: 85%; }
    </style>
</head>
<body>

    <div id="auth-overlay">
        <div class="auth-card">
            <h2 style="font-family:'Bungee'; color:var(--gold); margin:0;">DANH T√çNH</h2>
            <p style="font-size:0.8rem; color:#aaa;">Nh·∫≠p ƒë·ªÉ m·ªü c√°c ch·∫∑ng ti·∫øp theo</p>
            <input type="text" id="input-name" placeholder="H·ªç v√† T√™n c·ªßa em">
            <input type="text" id="input-class" placeholder="L·ªõp (V√≠ d·ª•: 5A1)">
            <button onclick="saveAuthData()" style="background:var(--primary); border:none; padding:12px; width:100%; border-radius:10px; font-weight:bold; color:white; cursor:pointer;">X√ÅC NH·∫¨N</button>
            <button onclick="hideAuthForm()" style="background:transparent; color:#777; border:none; margin-top:10px; cursor:pointer;">ƒê·ªÉ sau</button>
        </div>
    </div>

    <div class="welcome-banner"><h1 class="welcome-text">TH√ÅM HI·ªÇM VI·ªÜT NAM C√ôNG ROBOT</h1></div>

    <header class="game-header">
        <div style="display:flex; align-items:center; gap:10px;">
            <div style="width:30px; height:30px; border-radius:50%; background:var(--gold);"></div>
            <div>
                <span id="user-display" style="font-size:0.9rem; font-weight:bold; color:var(--gold);">Kh√°ch Th√°m Hi·ªÉm</span>
                <span id="class-display" style="font-size:0.7rem; color:#ccc; display:block;">Vui l√≤ng nh·∫≠p t√™n</span>
            </div>
        </div>
        <button onclick="showAuthForm()" style="background:var(--primary); border:none; padding:5px 10px; border-radius:10px; font-size:0.7rem; font-weight:bold; color:white;">ƒêƒÇNG K√ù</button>
    </header>

    <div class="map-container">
        <div class="map-relative-box">
            <img src="Bandogame.jpg" alt="B·∫£n ƒë·ªì" class="map-image">
            <script>
                for(let i=19; i<=35; i++) {
                    document.write(`<div class="station" id="st-${i}" onclick="handleStageClick(${i})">${i}</div>`);
                }
            </script>
        </div>
    </div>

    <footer class="game-footer">
        <a href="tuido.html" class="btn-nav">üéí T√öI ƒê·ªí</a>
        <a href="bang-vang.html" class="btn-nav">üèÜ B·∫¢NG V√ÄNG</a>
        <button onclick="showAuthForm()" class="btn-nav">üë§ T√äN</button>
    </footer>

    <script>
        // L·ªãch m·ªü tr·∫°m (C·∫≠p nh·∫≠t ƒë√∫ng ng√†y c·ªßa b·∫°n)
        const SCHEDULE = {
            19: "2024-01-01", 20: "2026-01-13", 21: "2026-01-20", 
            22: "2026-01-27", 23: "2026-02-03", 24: "2026-02-10" 
            // ... th√™m c√°c tu·∫ßn ti·∫øp theo v√†o ƒë√¢y
        };

        const currentName = localStorage.getItem('studentName');
        const currentClass = localStorage.getItem('studentClass');

        window.onload = function() {
            if(currentName) {
                document.getElementById('user-display').innerText = currentName;
                document.getElementById('class-display').innerText = "L·ªõp: " + currentClass;
            }
            updateMap();
        };

        function updateMap() {
            const now = new Date();
            for (let i = 19; i <= 35; i++) {
                const el = document.getElementById(`st-${i}`);
                if (!el) continue;

                // V√íNG 19: Lu√¥n m·ªü cho t·∫•t c·∫£
                if (i === 19) continue;

                // C√ÅC V√íNG C√íN L·∫†I:
                const openDate = SCHEDULE[i] ? new Date(SCHEDULE[i]) : new Date("2099-01-01");
                
                // Ki·ªÉm tra 2 ƒëi·ªÅu ki·ªán: Ph·∫£i c√≥ T√™n V√Ä Ph·∫£i ƒë·∫øn ng√†y
                if (!currentName || now < openDate) {
                    el.classList.add('locked');
                } else {
                    el.classList.remove('locked');
                }
            }
        }

        function handleStageClick(num) {
            const el = document.getElementById(`st-${num}`);
            
            // N·∫øu l√† v√≤ng 19 -> Cho v√†o lu√¥n
            if (num === 19) {
                window.location.href = "19.html";
                return;
            }

            // N·∫øu b·ªã kh√≥a
            if (el.classList.contains('locked')) {
                if (!currentName) {
                    alert("‚ö†Ô∏è Em c·∫ßn nh·∫≠p H·ªç t√™n v√† L·ªõp ƒë·ªÉ m·ªü c√°c v√≤ng t·ª´ 20 tr·ªü ƒëi!");
                    showAuthForm();
                } else {
                    alert(`üïí Ch·∫∑ng n√†y ch∆∞a ƒë·∫øn ng√†y m·ªü! (Ng√†y m·ªü: ${SCHEDULE[num]})`);
                }
                return;
            }

            // N·∫øu th·ªèa m√£n -> V√†o thi
            window.location.href = num + ".html";
        }

        function showAuthForm() { document.getElementById('auth-overlay').style.display = 'flex'; }
        function hideAuthForm() { document.getElementById('auth-overlay').style.display = 'none'; }

        function saveAuthData() {
            const name = document.getElementById('input-name').value.trim();
            const cls = document.getElementById('input-class').value.trim();
            if (name.length < 5 || cls.length < 2) {
                alert("Vui l√≤ng nh·∫≠p ƒë·ªß H·ªç t√™n v√† L·ªõp!");
                return;
            }
            localStorage.setItem('studentName', name);
            localStorage.setItem('studentClass', cls);
            location.reload();
        }
    </script>
</body>
</html>